<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- â€» reset.css | ğŸ‘‰ ë™ì¼í•œ CSS ìŠ¤íƒ€ì¼ì„ ë³´ì—¬ì£¼ê¸° ìœ„í•´  ì›¹ë¸Œë¼ìš°ì €ë§ˆë‹¤ ì ìš©ë˜ì–´ ìˆëŠ” default ìŠ¤íƒ€ì¼ ê°’ì„ ì´ˆê¸°í™” ì£¼ëŠ” íŒŒì¼ -->
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/index.css" />
    <title>Document</title>
  </head>
  <body>
    <!-- layoutì€ header, form, sectionìœ¼ë¡œ ë‚˜ëˆ” -->
    <header>
      <h1>ìµœê³  í‰ì  ì˜í™” ì½œë ‰ì…˜</h1>
    </header>
    <form action="">
      <span>ì˜í™” ê²€ìƒ‰ : </span>
      <input type="text" placeholder="ì˜í™” ì œëª©ì„ ê²€ìƒ‰í•´ ë³´ì„¸ìš”" />
      <button>ê²€ìƒ‰</button>
    </form>
    <section id="cards">
      <div class="card-bg">
        <div class="card-content">
          <!-- ì´ë¯¸ì§€ í¬ê¸° 260*390 -->
          <img src="https://image.tmdb.org/t/p/w500/q6y0Go1tsGEsmtFryDOJo3dEmqu.jpg" alt="movie image" />
          <h3>movie title</h3>
          <p class="card-overview">
            overview : Lorem ipsum dolor sit amet consectetur adipisicing elit. Eum iste voluptas labore adipisci omnis
            sint debitis, consequuntur earum et quasi aut ducimus. Enim ad, sapiente dignissimos amet voluptate quidem
            commodi Lorem ipsum dolor sit amet consectetur adipisicing elit. Pariatur labore modi mollitia tempora
            aspernatur ea, veritatis illum vero nobis iure animi in quis quidem consequuntur, quisquam nostrum maxime
            aliquam neque.
          </p>
          <p class="card-rating">rating 8.5</p>
        </div>
      </div>
      <div class="card-bg">
        <div class="card-content">
          <img src="https://image.tmdb.org/t/p/w500/q6y0Go1tsGEsmtFryDOJo3dEmqu.jpg" alt="movie image" />
          <h3>movie title <br />movie title</h3>
          <p class="card-overview">
            overview : Lorem ipsum dolor sit amet consectetur adipisicing elit. Eum iste voluptas labore adipisci omnis
            sint debitis, consequuntur earum et quasi aut ducimus. Enim ad, sapiente dignissimos amet voluptate quidem
            commodi Lorem ipsum dolor sit amet consectetur adipisicing elit. Pariatur labore modi mollitia tempora
            aspernatur ea, veritatis illum vero nobis iure animi in quis quidem consequuntur, quisquam nostrum maxime
            aliquam neque.
          </p>
          <p class="card-rating">rating 8.5</p>
        </div>
      </div>
      <div class="card-bg">
        <div class="card-content">
          <img src="" alt="movie image" />
          <h3>movie title</h3>
          <p class="card-overview">overview</p>
          <p class="card-rating">rating 8.5</p>
        </div>
      </div>
      <div class="card-bg">
        <div class="card-content">
          <img src="" alt="movie image" />
          <h3>movie title</h3>
          <p class="card-overview">overview</p>
          <p class="card-rating">rating 8.5</p>
        </div>
      </div>
    </section>

    <script>
      // ğŸ’™ window.onloadëŠ” í•¨ìˆ˜í˜¸ì¶œì„ ë”°ë¡œ í•˜ì§€ ì•Šì•„ë„ ì‚¬ìš©ìê°€ onloadí•˜ëŠ” ìˆœê°„ ì‹¤í–‰ë ê±°ì„
      // window.onload | window ê°ì²´ì˜ load ì´ë²¤íŠ¸ëŠ” ìŠ¤íƒ€ì¼, ì´ë¯¸ì§€ ë“±ì˜ ë¦¬ì†ŒìŠ¤ë“¤ì´ ëª¨ë‘ ë¡œë“œë˜ì—ˆì„ ë•Œ ì‹¤í–‰ë¨.
      window.onload = function () {
        getMovieAPI();
      };

      function alertId(movieId) {
        alert(`ì˜í™” id : ${movieId}`);
      }

      // ì˜í™” API ìš”ì²­ ì½”ë“œ
      const options = {
        method: 'GET',
        headers: {
          accept: 'application/json',
          Authorization:
            'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJhYjdkNzRhNTRiYzEzNTE4ZDgyMTc1MjAzNzM4MzliNSIsInN1YiI6IjY0NzA4OGI1NTQzN2Y1MDE0NzVmMDU0ZSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.FaD0cXTgqDH5QUE4-ZoUBQJFr9fuQMr0VtpdOJEbTxE',
        },
      };

      // ì˜í™” APIëŠ” ìš”ì²­ì€ 'ê²€ìƒ‰í–ˆì„ ë•Œ, ê·¸ë¦¬ê³  documentê°€ loadí–ˆì„ ë•Œ' í•„ìš”! ê·¸ë•Œë§ˆë‹¤ ì‹¤í–‰ë  í•¨ìˆ˜ì•ˆì— 'ì˜í™” APIìš”ì²­ì½”ë“œ' ë„£ì–´ì£¼ë©´ ë¨.
      function getMovieAPI() {
        fetch('https://api.themoviedb.org/3/movie/top_rated?language=en-US&page=1', options)
          .then(response => response.json())
          .then(json => {
            console.log(json);

            // ğŸ’™ ì—¬ê¸°ì„œ ë°›ì€ ì •ë³´ ë‹¤ í•´ê²°í•˜ê³  ì‹¶ì€ë° ì•„ë˜ì˜ .catch(ì–´ì©Œêµ¬) ë•Œë¬¸ì— ë¬¸ì œìƒê¸¸ê¹Œë´ ì¼ë‹¨ ë‹¤ë¥¸ í•¨ìˆ˜ë¡œ ë³´ë‚´ëŠ” ë°©ë²• ì„ íƒ
            displayItems(json);
          })
          .catch(err => console.error(err));
      }
      function displayItems(movieInfos) {
        // 'movieInfos'ëŠ” ì˜í™” API ìš”ì²­ì½”ë“œë¡œ ë°›ì€ ìµœê³  í‰ì  ì˜í™” ì»¬ë ‰ì…˜ ë­‰ì¹˜ì½”ë“œì„

        // console.log(movieInfos);  // ì¸ìë¡œ ì˜ ë°›ì•„ì™”ëŠ”ì§€ í™•ì¸
        let movies = movieInfos['results']; // ì¼ë‹¨ í•„ìš”í•œ ë¶€ë¶„ë§Œ ë°œì·Œ
        // console.log(movies); // ë°œì·Œ ì˜ëëŠ”ì§€ í™•ì¸

        // ì›ë˜ ìƒˆ ì •ë³´ ë„£ì–´ì£¼ë ¤ë˜ ê³³ì— ì›ë˜ ìˆë˜ ì •ë³´ ì‚­ì œ
        let parent = document.getElementsByTagName('section')[0];
        // section tagì— ìˆëŠ” 'card-bg' classë¥¼ ê°€ì§„ ëª¨ë“  ìš”ì†Œë¥¼ ì œê±°í•˜ê³  ì‹¶ì—ˆëŠ”ë°,
        // querySelectorAll ì‚¬ìš©ì‹œ 'card-bg' classë¥¼ ê°€ì§„ ëª¨ë“  ìš”ì†Œë¥¼ í•œêº¼ë²ˆì— ë¶ˆëŸ¬ì™€ì„œ forEachë¬¸ì„ ì‚¬ìš©í•´ì•¼í–ˆìŒ.
        let children = parent.querySelectorAll('.card-bg');
        // console.log(children);
        children.forEach(child => {
          parent.removeChild(child);
        });
        // ë°œì·Œí•œ ë¶€ë¶„ì´ ë°°ì—´ë¡œ ë˜ì–´ ìˆê³ , ìš°ë¦¬ëŠ” ê·¸ ê°ê°ì˜ ë°°ì—´ ìš”ì†Œë§ˆë‹¤ ê°€ì ¸ì™€ì•¼í•  ì •ë³´ê°€ ìˆìŒ.
        // ë”°ë¼ì„œ 1.ê°ê°ì˜ ë°°ì—´ ìš”ì†Œ(movie) ê°€ì ¸ì˜¤ê¸°=> forEach í™œìš©  2. ê°€ì ¸ì˜¨ ë°°ì—´ìš”ì†Œì—ì„œ ì›í•˜ëŠ” ì†ì„± ë½‘ê¸°
        movies.forEach(movie => {
          // console.log(movie); // movie ì˜ ê°€ì ¸ì™”ëŠ”ì§€ í™•ì¸

          // ê°€ì§€ê³  ì™€ì•¼í•  ì†ì„± | (id, title, overview, poster_path, vote_average)
          let id = movie['id'];
          let title = movie['title'];
          let overview = movie['overview'];
          let poster_path = 'https://image.tmdb.org/t/p/w500' + movie['poster_path'];
          let vote_average = movie['vote_average'];
          // poster_pathëŠ” ì˜í™” API ìš”ì²­ì½”ë“œë¡œ ë°›ì€ ë­‰ì¹˜ì—ì„œ ë¶ˆì™„ì „í–ˆìŒ.('https://developer.themoviedb.org/docs/image-basics ')ì—¬ê¸°ì„œ ì•Œë ¤ì¤€ ì •ë³´ì™€ í•©ì¹œí›„ console.logì°ì–´ì„œ í™•ì¸
          // console.log(poster_path);
          // console.log(id, title, overview, poster_path, vote_average);

          // ì´ì œ ê°€ì ¸ì˜¨ ì •ë³´ë¥¼ document htmlíŒŒì¼ ì ì ˆí•œ ìœ„ì¹˜ì— ë¶™ì—¬ë„£ì–´ì¤˜ì•¼í•¨.
          // ğŸ’œ ë‘ë²ˆì§¸ div alertIdì— ìˆëŠ” this.id => onclick ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¨ DOMìš”ì†Œì¸ 'ë‘ë²ˆì§¸ div'ì— ì ‘ê·¼.
          let temp_html = `
          <div class="card-bg">
            <div id="${id}" class="card-content" onclick="alertId(this.id)">
              <!-- ì´ë¯¸ì§€ í¬ê¸° 260*390 -->
              <img src="${poster_path}" alt="movie image" />
              <h3>${title}</h3>
              <p class="card-overview">
                ${overview}
              </p>
              <p class="card-rating">Rating : ${vote_average}</p>
            </div>
          </div>
          `;

          // TagNameìœ¼ë¡œ í˜¸ì¶œí•  ë•ŒëŠ” ëª‡ë²ˆì§¸ì˜ tagë¥¼ ì‚¬ìš©í•  ê±´ì§€ ëª…ì‹œí•´ì£¼ì–´ì•¼í•¨.
          // Element.insertAdjacentHTML() ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” ìœ„ì¹˜ì— íŠ¹ì •í…ìŠ¤íŠ¸ íŒŒì‹± í›„ íŠ¹ì • ìœ„ì¹˜ì— node(ìš”ì†Œê°™ì€ ê±°)ì¶”ê°€
          document.getElementsByTagName('section')[0].insertAdjacentHTML('afterbegin', temp_html);
        });
      }
    </script>
  </body>
</html>
